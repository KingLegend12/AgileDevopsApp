{"ast":null,"code":"import axios from \"axios\";\nimport { fetchTicketLoading, fetchTicketSuccess, fetchTicketFail, searchTickets, fetchSingleTicketLoading, fetchSingleTicketSuccess, fetchSingleTicketFail, replyTicketLoading, replyTicketSuccess, replyTicketFail, closeTicketLoading, closeTicketSuccess, closeTicketFail } from \"./ticketSlice\";\nimport { getAllTickets, getSingleTicket, updateReplyTicket, updateTicketStatusClosed } from \"../../api/ticketApi\";\nexport const fetchAllTickets = () => async dispatch => {\n  dispatch(fetchTicketLoading());\n\n  try {\n    const result = await getAllTickets();\n    dispatch(fetchTicketSuccess(result.data.result));\n\n    if (!result.data.result) {\n      dispatch(fetchTicketFail({\n        message: \"error couldn't load\"\n      }));\n    }\n\n    console.log(result);\n  } catch (error) {\n    dispatch(fetchTicketFail(error.message));\n  }\n};\nexport const filterSearchTicket = str => dispatch => {\n  dispatch(searchTickets(str));\n};\nexport const fetchSingleTicket = _id => async dispatch => {\n  dispatch(fetchSingleTicketLoading());\n\n  try {\n    const result = await getSingleTicket(_id);\n    dispatch(fetchSingleTicketSuccess(result.data.result.length && result.data.result[0]));\n  } catch (error) {\n    dispatch(fetchSingleTicketFail(error.message));\n  }\n};\n\nfunction showNotification(id, text) {\n  return {\n    type: \"SHOW_NOTIFICATION\",\n    id,\n    text\n  };\n}\n\nfunction hideNotification(id) {\n  return {\n    type: \"HIDE_NOTIFICATION\",\n    id\n  };\n}\n\nlet nextNotificationId = 0;\nexport function showNotificationWithTimeout(dispatch, text) {\n  // Assigning IDs to notifications lets reducer ignore HIDE_NOTIFICATION\n  // for the notification that is not currently visible.\n  // Alternatively, we could store the timeout ID and call\n  // clearTimeout(), but we’d still want to do it in a single place.\n  const id = nextNotificationId++;\n  dispatch(showNotification(id, text));\n  setTimeout(() => {\n    dispatch(hideNotification(id));\n  }, 5000);\n}\nexport const replyOnTicket = (_id, msgObj) => async dispatch => {\n  dispatch(replyTicketLoading());\n\n  try {\n    const result = await updateReplyTicket(_id, msgObj);\n    console.log(result);\n\n    if (result.status === \"error\") {\n      return dispatch(replyTicketFail(result.message));\n    }\n\n    dispatch(fetchSingleTicket(_id)); //dispatch(replyTicketSuccess(\"Message envoyée avec succes\"));\n\n    showNotificationWithTimeout(dispatch, \"Message envoyée avec succes\");\n  } catch (error) {\n    console.log(error.message);\n    dispatch(replyTicketFail(error.message));\n  }\n};\nexport const closeTicket = _id => async dispatch => {\n  dispatch(closeTicketLoading());\n\n  try {\n    const result = await updateTicketStatusClosed(_id);\n\n    if (result.status === \"error\") {\n      return dispatch(closeTicketFail(result.message));\n    }\n\n    dispatch(fetchSingleTicket(_id));\n    dispatch(closeTicketSuccess(\"Ce ticket est fermé\"));\n  } catch (error) {\n    console.log(error.message);\n    dispatch(closeTicketFail(error.message));\n  }\n};","map":{"version":3,"sources":["/Users/drissjd/Desktop/InternShipApp/internship_frontend/src/pages/ticket-lists/ticketsAction.js"],"names":["axios","fetchTicketLoading","fetchTicketSuccess","fetchTicketFail","searchTickets","fetchSingleTicketLoading","fetchSingleTicketSuccess","fetchSingleTicketFail","replyTicketLoading","replyTicketSuccess","replyTicketFail","closeTicketLoading","closeTicketSuccess","closeTicketFail","getAllTickets","getSingleTicket","updateReplyTicket","updateTicketStatusClosed","fetchAllTickets","dispatch","result","data","message","console","log","error","filterSearchTicket","str","fetchSingleTicket","_id","length","showNotification","id","text","type","hideNotification","nextNotificationId","showNotificationWithTimeout","setTimeout","replyOnTicket","msgObj","status","closeTicket"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nimport {\n  fetchTicketLoading,\n  fetchTicketSuccess,\n  fetchTicketFail,\n  searchTickets,\n  fetchSingleTicketLoading,\n  fetchSingleTicketSuccess,\n  fetchSingleTicketFail,\n  replyTicketLoading,\n  replyTicketSuccess,\n  replyTicketFail,\n  closeTicketLoading,\n  closeTicketSuccess,\n  closeTicketFail,\n} from \"./ticketSlice\";\n\nimport {\n  getAllTickets,\n  getSingleTicket,\n  updateReplyTicket,\n  updateTicketStatusClosed,\n} from \"../../api/ticketApi\";\nexport const fetchAllTickets = () => async (dispatch) => {\n  dispatch(fetchTicketLoading());\n\n  try {\n    const result = await getAllTickets();\n    dispatch(fetchTicketSuccess(result.data.result));\n    if (!result.data.result) {\n      dispatch(fetchTicketFail({ message: \"error couldn't load\" }));\n    }\n    console.log(result);\n  } catch (error) {\n    dispatch(fetchTicketFail(error.message));\n  }\n};\n\nexport const filterSearchTicket = (str) => (dispatch) => {\n  dispatch(searchTickets(str));\n};\n\nexport const fetchSingleTicket = (_id) => async (dispatch) => {\n  dispatch(fetchSingleTicketLoading());\n  try {\n    const result = await getSingleTicket(_id);\n    dispatch(\n      fetchSingleTicketSuccess(\n        result.data.result.length && result.data.result[0]\n      )\n    );\n  } catch (error) {\n    dispatch(fetchSingleTicketFail(error.message));\n  }\n};\n\nfunction showNotification(id, text) {\n  return { type: \"SHOW_NOTIFICATION\", id, text };\n}\nfunction hideNotification(id) {\n  return { type: \"HIDE_NOTIFICATION\", id };\n}\n\nlet nextNotificationId = 0;\nexport function showNotificationWithTimeout(dispatch, text) {\n  // Assigning IDs to notifications lets reducer ignore HIDE_NOTIFICATION\n  // for the notification that is not currently visible.\n  // Alternatively, we could store the timeout ID and call\n  // clearTimeout(), but we’d still want to do it in a single place.\n  const id = nextNotificationId++;\n  dispatch(showNotification(id, text));\n\n  setTimeout(() => {\n    dispatch(hideNotification(id));\n  }, 5000);\n}\n\nexport const replyOnTicket = (_id, msgObj) => async (dispatch) => {\n  dispatch(replyTicketLoading());\n  try {\n    const result = await updateReplyTicket(_id, msgObj);\n    console.log(result);\n    if (result.status === \"error\") {\n      return dispatch(replyTicketFail(result.message));\n    }\n\n    dispatch(fetchSingleTicket(_id));\n\n    //dispatch(replyTicketSuccess(\"Message envoyée avec succes\"));\n    showNotificationWithTimeout(dispatch, \"Message envoyée avec succes\");\n  } catch (error) {\n    console.log(error.message);\n    dispatch(replyTicketFail(error.message));\n  }\n};\n\nexport const closeTicket = (_id) => async (dispatch) => {\n  dispatch(closeTicketLoading());\n  try {\n    const result = await updateTicketStatusClosed(_id);\n    if (result.status === \"error\") {\n      return dispatch(closeTicketFail(result.message));\n    }\n\n    dispatch(fetchSingleTicket(_id));\n\n    dispatch(closeTicketSuccess(\"Ce ticket est fermé\"));\n  } catch (error) {\n    console.log(error.message);\n    dispatch(closeTicketFail(error.message));\n  }\n};\n"]},"metadata":{},"sourceType":"module"}