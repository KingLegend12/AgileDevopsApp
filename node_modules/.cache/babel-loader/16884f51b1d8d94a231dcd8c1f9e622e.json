{"ast":null,"code":"import _regeneratorRuntime from\"/Users/drissjd/Desktop/AgileProject/agile_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/drissjd/Desktop/AgileProject/agile_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/drissjd/Desktop/AgileProject/agile_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{getUserProfile}from\"../../pages/dashboard/userAction\";import{useHistory,useLocation}from\"react-router-dom\";import{Container,Row,Col,Form,Button,Spinner,Alert}from\"react-bootstrap\";import{loginPending,loginSuccess,loginFail}from\"./Login.Slice\";import{useDispatch,useSelector}from\"react-redux\";import{userLogin}from\"../../api/userApi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var LoginForm=function LoginForm(_ref){var frmSwitcher=_ref.frmSwitcher;var dispatch=useDispatch();var history=useHistory();var location=useLocation();var _useSelector=useSelector(function(state){return state.login;}),isLoading=_useSelector.isLoading,error=_useSelector.error;useEffect(function(){sessionStorage.getItem(\"accessJWT\")&&history.push(\"/dashboard\");},[history]);var _useState=useState(\"fakeemail@email.com\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"sfsd#3Dsga\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var handleOnChange=function handleOnChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;switch(name){case\"email\":setEmail(value);break;case\"password\":setPassword(value);break;default:break;}console.log(name,value);};var handleOnSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var isAuth;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!email||!password){alert(\"Veuillez remplir les champs\");}dispatch(loginPending());_context.prev=3;_context.next=6;return userLogin({email:email,password:password});case 6:isAuth=_context.sent;if(!(isAuth.status===\"error\")){_context.next=9;break;}return _context.abrupt(\"return\",dispatch(loginFail(isAuth.message)));case 9:dispatch(loginSuccess());dispatch(getUserProfile());history.push(\"/dashboard\");_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](3);dispatch(loginFail(_context.t0.message));case 17:case\"end\":return _context.stop();}}},_callee,null,[[3,14]]);}));return function handleOnSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-info text-center\",children:\"Se Connecter\"}),/*#__PURE__*/_jsx(\"hr\",{}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),/*#__PURE__*/_jsxs(Form,{autoComplete:\"off\",onSubmit:handleOnSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Addresse Email\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",name:\"email\",onChange:handleOnChange,value:email,placeholder:\"Entrez votre addresse email\",required:true})]}),/*#__PURE__*/_jsxs(Form.Group,{children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Mot de passe\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",name:\"password\",onChange:handleOnChange,value:password,placeholder:\"Mot de passe\",required:true})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"Se connecter\"}),isLoading&&/*#__PURE__*/_jsx(Spinner,{variant:\"primary\",animation:\"border\"})]}),/*#__PURE__*/_jsx(\"hr\",{})]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"a\",{href:\"#!\",onClick:function onClick(){return frmSwitcher(\"reset\");},children:\"Mot de passe oubli\\xE9 ?\"})})}),/*#__PURE__*/_jsx(Row,{className:\"py-4\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"a\",{href:\"/registration\",children:\"Cr\\xE9er un compte\"})})})]});};","map":{"version":3,"sources":["/Users/drissjd/Desktop/AgileProject/agile_frontend/src/components/login/Login.comp.js"],"names":["React","useEffect","useState","getUserProfile","useHistory","useLocation","Container","Row","Col","Form","Button","Spinner","Alert","loginPending","loginSuccess","loginFail","useDispatch","useSelector","userLogin","LoginForm","frmSwitcher","dispatch","history","location","state","login","isLoading","error","sessionStorage","getItem","push","email","setEmail","password","setPassword","handleOnChange","e","target","name","value","console","log","handleOnSubmit","preventDefault","alert","isAuth","status","message"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { getUserProfile } from \"../../pages/dashboard/userAction\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport {\n  Container,\n  Row,\n  Col,\n  Form,\n  Button,\n  Spinner,\n  Alert,\n} from \"react-bootstrap\";\nimport { loginPending, loginSuccess, loginFail } from \"./Login.Slice\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { userLogin } from \"../../api/userApi\";\nexport const LoginForm = ({ frmSwitcher }) => {\n  const dispatch = useDispatch();\n  const history = useHistory();\n  let location = useLocation();\n  const { isLoading, error } = useSelector((state) => state.login);\n  useEffect(() => {\n    sessionStorage.getItem(\"accessJWT\") && history.push(\"/dashboard\");\n  }, [history]);\n  const [email, setEmail] = useState(\"fakeemail@email.com\");\n  const [password, setPassword] = useState(\"sfsd#3Dsga\");\n\n  const handleOnChange = (e) => {\n    const { name, value } = e.target;\n\n    switch (name) {\n      case \"email\":\n        setEmail(value);\n        break;\n      case \"password\":\n        setPassword(value);\n        break;\n      default:\n        break;\n    }\n    console.log(name, value);\n  };\n  const handleOnSubmit = async (e) => {\n    e.preventDefault();\n    if (!email || !password) {\n      alert(\"Veuillez remplir les champs\");\n    }\n    dispatch(loginPending());\n    try {\n      const isAuth = await userLogin({ email, password });\n\n      if (isAuth.status === \"error\") {\n        return dispatch(loginFail(isAuth.message));\n      }\n\n      dispatch(loginSuccess());\n      dispatch(getUserProfile());\n      history.push(\"/dashboard\");\n    } catch (error) {\n      dispatch(loginFail(error.message));\n    }\n  };\n  return (\n    <Container>\n      <Row>\n        <Col>\n          <h1 className=\"text-info text-center\">Se Connecter</h1>\n          <hr></hr>\n          {error && <Alert variant=\"danger\">{error}</Alert>}\n          <Form autoComplete=\"off\" onSubmit={handleOnSubmit}>\n            <Form.Group>\n              <Form.Label>Addresse Email</Form.Label>\n              <Form.Control\n                type=\"email\"\n                name=\"email\"\n                onChange={handleOnChange}\n                value={email}\n                placeholder=\"Entrez votre addresse email\"\n                required\n              />\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Mot de passe</Form.Label>\n              <Form.Control\n                type=\"password\"\n                name=\"password\"\n                onChange={handleOnChange}\n                value={password}\n                placeholder=\"Mot de passe\"\n                required\n              />\n            </Form.Group>\n            <Button type=\"submit\">Se connecter</Button>\n            {isLoading && <Spinner variant=\"primary\" animation=\"border\" />}\n          </Form>\n          <hr />\n        </Col>\n      </Row>\n\n      <Row>\n        <Col>\n          <a href=\"#!\" onClick={() => frmSwitcher(\"reset\")}>\n            Mot de passe oublié ?\n          </a>\n        </Col>\n      </Row>\n      <Row className=\"py-4\">\n        <Col>\n          <a href=\"/registration\">Créer un compte</a>\n        </Col>\n      </Row>\n    </Container>\n  );\n};\nLoginForm.propTypes = {\n  frmSwitcher: PropTypes.func.isRequired,\n};\n"]},"metadata":{},"sourceType":"module"}