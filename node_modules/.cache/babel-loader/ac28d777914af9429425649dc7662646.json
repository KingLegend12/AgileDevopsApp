{"ast":null,"code":"import _regeneratorRuntime from\"/Users/drissjd/Desktop/AgileProject/agile_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/drissjd/Desktop/AgileProject/agile_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";var rootUrl=\"https://devagileicrm.herokuapp.com/v1/\";var loginUrl=rootUrl+\"user/login\";var userProfileUrl=rootUrl+\"user\";var logoutUrl=rootUrl+\"user/logout\";var newAccessJWT=rootUrl+\"tokens\";var userVerificationUrl=userProfileUrl+\"/verify\";export var userRegistration=function userRegistration(frmData){return new Promise(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resolve,reject){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(userProfileUrl,frmData);case 3:res=_context.sent;resolve(res.data);if(res.data.status===\"success\"){resolve(res.data);}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);reject(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());};export var userRegistrationVerification=function userRegistrationVerification(frmData){return new Promise(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(resolve,reject){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.patch(userVerificationUrl,frmData);case 3:res=_context2.sent;resolve(res.data);if(res.data.status===\"success\"){resolve(res.data);}_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);reject({status:\"error\",message:_context2.t0.error});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function(_x3,_x4){return _ref2.apply(this,arguments);};}());};export var userLogin=function userLogin(frmData){return new Promise(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(resolve,reject){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.post(loginUrl,frmData);case 3:res=_context3.sent;resolve(res.data);if(res.data.status===\"success\"){sessionStorage.setItem(\"accessJWT\",res.data.accessJWT);localStorage.setItem(\"crmSite\",JSON.stringify({refreshJWT:res.data.refreshJWT}));}_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);reject(_context3.t0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function(_x5,_x6){return _ref3.apply(this,arguments);};}());};export var fetchUser=function fetchUser(){return new Promise(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(resolve,reject){var accessJWT,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;accessJWT=sessionStorage.getItem(\"accessJWT\");if(!accessJWT){reject(\"Token not found!\");}_context4.next=5;return axios.get(userProfileUrl,{headers:{Authorization:accessJWT}});case 5:res=_context4.sent;resolve(res.data);_context4.next=13;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);reject(_context4.t0.message);case 13:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);}));return function(_x7,_x8){return _ref4.apply(this,arguments);};}());};export var fetchNewAccessJWT=function fetchNewAccessJWT(){return new Promise(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(resolve,reject){var _JSON$parse,refreshJWT,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_JSON$parse=JSON.parse(localStorage.getItem(\"crmSite\")),refreshJWT=_JSON$parse.refreshJWT;if(!refreshJWT){reject(\"Token not found!\");}_context5.next=5;return axios.get(newAccessJWT,{headers:{Authorization:refreshJWT}});case 5:res=_context5.sent;if(res.data.status===\"success\"){sessionStorage.setItem(\"accessJWT\",res.data.accessJWT);}resolve(true);_context5.next=14;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](0);if(_context5.t0.message===\"Request failed with status code 403\"){localStorage.removeItem(\"crmSite\");}reject(false);case 14:case\"end\":return _context5.stop();}}},_callee5,null,[[0,10]]);}));return function(_x9,_x10){return _ref5.apply(this,arguments);};}());};export var userLogout=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return axios.delete(logoutUrl,{headers:{Authorization:sessionStorage.getItem(\"accessJWT\")}});case 3:_context6.next=8;break;case 5:_context6.prev=5;_context6.t0=_context6[\"catch\"](0);console.log(_context6.t0);case 8:case\"end\":return _context6.stop();}}},_callee6,null,[[0,5]]);}));return function userLogout(){return _ref6.apply(this,arguments);};}();","map":{"version":3,"sources":["/Users/drissjd/Desktop/AgileProject/agile_frontend/src/api/userApi.js"],"names":["axios","rootUrl","loginUrl","userProfileUrl","logoutUrl","newAccessJWT","userVerificationUrl","userRegistration","frmData","Promise","resolve","reject","post","res","data","status","userRegistrationVerification","patch","message","error","userLogin","sessionStorage","setItem","accessJWT","localStorage","JSON","stringify","refreshJWT","fetchUser","getItem","get","headers","Authorization","console","log","fetchNewAccessJWT","parse","removeItem","userLogout","delete"],"mappings":"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","sourcesContent":["import axios from \"axios\";\n\nconst rootUrl = \"https://devagileicrm.herokuapp.com/v1/\";\nconst loginUrl = rootUrl + \"user/login\";\nconst userProfileUrl = rootUrl + \"user\";\nconst logoutUrl = rootUrl + \"user/logout\";\nconst newAccessJWT = rootUrl + \"tokens\";\nconst userVerificationUrl = userProfileUrl + \"/verify\";\n\nexport const userRegistration = (frmData) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const res = await axios.post(userProfileUrl, frmData);\n\n      resolve(res.data);\n\n      if (res.data.status === \"success\") {\n        resolve(res.data);\n      }\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\nexport const userRegistrationVerification = (frmData) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const res = await axios.patch(userVerificationUrl, frmData);\n\n      resolve(res.data);\n      if (res.data.status === \"success\") {\n        resolve(res.data);\n      }\n    } catch (error) {\n      reject({ status: \"error\", message: error.error });\n    }\n  });\n};\n\nexport const userLogin = (frmData) => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const res = await axios.post(loginUrl, frmData);\n\n      resolve(res.data);\n\n      if (res.data.status === \"success\") {\n        sessionStorage.setItem(\"accessJWT\", res.data.accessJWT);\n        localStorage.setItem(\n          \"crmSite\",\n          JSON.stringify({ refreshJWT: res.data.refreshJWT })\n        );\n      }\n    } catch (error) {\n      reject(error);\n    }\n  });\n};\n\nexport const fetchUser = () => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const accessJWT = sessionStorage.getItem(\"accessJWT\");\n\n      if (!accessJWT) {\n        reject(\"Token not found!\");\n      }\n\n      const res = await axios.get(userProfileUrl, {\n        headers: {\n          Authorization: accessJWT,\n        },\n      });\n\n      resolve(res.data);\n    } catch (error) {\n      console.log(error);\n      reject(error.message);\n    }\n  });\n};\n\nexport const fetchNewAccessJWT = () => {\n  return new Promise(async (resolve, reject) => {\n    try {\n      const { refreshJWT } = JSON.parse(localStorage.getItem(\"crmSite\"));\n\n      if (!refreshJWT) {\n        reject(\"Token not found!\");\n      }\n\n      const res = await axios.get(newAccessJWT, {\n        headers: {\n          Authorization: refreshJWT,\n        },\n      });\n\n      if (res.data.status === \"success\") {\n        sessionStorage.setItem(\"accessJWT\", res.data.accessJWT);\n      }\n\n      resolve(true);\n    } catch (error) {\n      if (error.message === \"Request failed with status code 403\") {\n        localStorage.removeItem(\"crmSite\");\n      }\n\n      reject(false);\n    }\n  });\n};\n\nexport const userLogout = async () => {\n  try {\n    await axios.delete(logoutUrl, {\n      headers: {\n        Authorization: sessionStorage.getItem(\"accessJWT\"),\n      },\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\n"]},"metadata":{},"sourceType":"module"}